<!DOCTYPE html>
<html>
<head>
  <title>YouTube Video Search (Fixed Embed Version)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }

    input[type="text"] {
      width: 70%;
      padding: 10px;
      font-size: 16px;
    }

    button {
      padding: 10px 15px;
      font-size: 16px;
      margin-left: 10px;
      cursor: pointer;
    }

    .video {
      margin-top: 30px;
    }

    iframe {
      width: 100%;
      height: 315px;
    }

    h2 {
      font-size: 18px;
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <h1>YouTube Video Search</h1>
  <input type="text" id="searchInput" placeholder="Search for videos..." />
  <button onclick="searchVideos()">Search</button>

  <div id="results"></div>

  <script>
    const API_KEY = 'AIzaSyBt5lB25IQUMDuCOTK3TAJNoFu9GYaIxBc';  // Replace this with your YouTube API key

    function searchVideos() {
      const query = document.getElementById('searchInput').value;
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = 'Loading...';

      fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&maxResults=6&q=${encodeURIComponent(query)}&key=${API_KEY}`)
        .then(response => response.json())
        .then(data => {
          resultsDiv.innerHTML = '';
          const videoIds = data.items.map(item => item.id.videoId).join(",");
          if (!videoIds) {
            resultsDiv.innerHTML = 'No videos found.';
            return;
          }
          // Now get video details to check embeddable status
          fetch(`https://www.googleapis.com/youtube/v3/videos?part=snippet,player,status&id=${videoIds}&key=${API_KEY}`)
            .then(response => response.json())
            .then(videoData => {
              let foundEmbeddable = false;
              videoData.items.forEach(item => {
                if (item.status && item.status.embeddable) {
                  foundEmbeddable = true;
                  const videoId = item.id;
                  const title = item.snippet.title;
                  const videoDiv = document.createElement('div');
                  videoDiv.className = 'video';
                  videoDiv.innerHTML = `
                    <iframe 
                      src="https://www.youtube-nocookie.com/embed/${videoId}" 
                      frameborder="0" 
                      allowfullscreen>
                    </iframe>
                    <h2>${title}</h2>
                  `;
                  resultsDiv.appendChild(videoDiv);
                }
              });
              if (!foundEmbeddable) {
                resultsDiv.innerHTML = 'No embeddable videos found.';
              }
            })
            .catch(error => {
              console.error('YouTube Video Details API Error:', error);
              resultsDiv.innerHTML = 'An error occurred while checking video details.';
            });
        })
        .catch(error => {
          console.error('YouTube API Error:', error);
          resultsDiv.innerHTML = 'An error occurred. Check the console for details.';
        });
    }
  </script>

</body>
</html>